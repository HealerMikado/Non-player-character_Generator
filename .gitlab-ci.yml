variables:
  GIT_SSL_NO_VERIFY: "1"
  DOCKER_TAG: docker-registry.beta.innovation.insee.eu/coding_dojo/pnj_generator_java
  MAVEN_CLI_OPTS: "--batch-mode --errors --fail-at-end --show-version -DinstallAtEnd=true -DdeployAtEnd=true"

stages:
  - test
  - build

helloworld:
  stage: test
  script:
    - echo "Hello world"
    - ls

buildjava:
  stage: build
  tags:
    - shell
  script:
    - 'mvn $MAVEN_CLI_OPTS package'
    - 'docker build -f java.Dockerfile -t $DOCKER_TAG .'
    - 'docker push $DOCKER_TAG'

